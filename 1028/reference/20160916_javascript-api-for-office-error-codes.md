
# 適用於 Office 的 JavaScript API 錯誤代碼
本文記錄您使用適用於 Office 的 JavaScript API (Office.js) 時可能遇到的錯誤訊息。

 _**適用於：**Office 增益集 |SharePoint 增益集 |Excel |Outlook |PowerPoint | Project |Word_


## 錯誤碼

下表列出錯誤碼、名稱和顯示的訊息，及其指示的條件。



|**[Error.code](../reference/shared/error.code.md)**|**[Error.name](../reference/shared/error.name.md)**|**[Error.message](../reference/shared/error.message.md)**|**狀況**|
|:-----|:-----|:-----|:-----|
|1000|無效的強制型轉類型|不支援指定的強制型轉類型|強制型轉類型不受主應用程式支援。(例如，OOXML 和 HTML 的強制型轉類型不受 Excel 支援。)|
|1001|資料讀取錯誤|不支援目前的選取範圍。|不支援使用者目前的選取範圍。(也就是說，它與支援的強制型轉類型有些不同)。|
|1002|無效的強制型轉類型|指定的強制型轉類型不相容於此繫結類型。|方案開發人員提供不相容的強制型轉型別和繫結型別組合。|
|1003|資料讀取錯誤|指定的 rowCount 或 columnCount 值不正確。|使用者提供無效的資料行或資料列計數。|
|1004|資料讀取錯誤|目前的選取範圍不相容於指定的強制型轉型別。|這個應用程式所指定的強制型轉型別不支援目前的選取範圍。|
|1005|資料讀取錯誤|指定的 startRow 或 startColumn 值不正確。|使用者提供無效的 startRow 或 startCol 值。|
|1006|資料讀取錯誤|當資料表包含合併的儲存格時，座標參數不能使用強制型轉型別 "Table"。|使用者嘗試從非均等表格 (也就是具有合併儲存格的資料表) 獲得部分資料。 |
|1007|資料讀取錯誤|文件大小過大。|使用者試圖取得大於目前支援大小的文件。|
|1008|資料讀取錯誤|要求的資料集太大。|使用者要求讀取超出主機增益集所定義之資料限制的資料。|
|1009|資料讀取錯誤|不支援指定的檔案類型。|使用者傳送無效的檔案類型。|
|2000|資料寫入錯誤|不支援提供的資料物件型別。 |提供不支援的資料物件。|
|2001|資料寫入錯誤|無法寫入至目前的選取範圍。|不支援寫入作業之使用者的目前選取範圍。(例如，當使用者選取影像時。)|
|2002|資料寫入錯誤|提供的資料物件不相容目前選取範圍的圖形或維度。|已選取多個儲存格 (且選取圖形不符合資料的圖形)。已選取多個儲存格 (且選取維度不符合資料的維度)。|
|2003|資料寫入錯誤|設定作業失敗，因為提供的資料物件將覆寫資料。|選取單一儲存格，且提供的資料物件會覆寫工作表中的資料。|
|2004|資料寫入錯誤|提供的資料物件不符合目前的選取範圍大小。|使用者提供比目前的選取範圍大小更大的物件。|
|2005|資料寫入錯誤|指定的 startRow 或 startColumn 值不正確。|使用者提供無效的 startRow 或 startCol 值。|
|2006|無效格式錯誤|指定的資料物件格式無效。|解決方案開發人員提供無效的 HTML 或 OOXML 字串、錯誤格式的 HTML 字串或無效的 OOXML 字串。|
|2007|無效的資料物件|指定的資料物件的型別不相容於目前的選取範圍。|解決方案開發人員提供與指定的強制型轉型別不相容的資料物件。|
|2008|資料寫入錯誤|TBD|TBD|
|2009|資料寫入錯誤|指定的資料物件太大。|使用者嘗試設定超過主機增益集所定義的資料限制以外的資料。|
|2010|資料寫入錯誤|當資料表包含合併的儲存格時，座標參數不能使用強制型轉型別 Table。|使用者嘗試從非均等表格 (也就是具有合併儲存格的資料表) 設定部分資料。|
|3000|繫結建立錯誤|無法繫結至目前選取範圍。|繫結不支援使用者的選取範圍。(例如，使用者選取影像或其他不受支援的物件。)|
|3001|繫結建立錯誤|TBD|TBD|
|3002|無效繫結錯誤|指定的繫結不存在。|開發人員嘗試繫結至不存在或已移除的繫結。|
|3003|繫結建立錯誤|不支援不連續的選取項目。|使用者正在進行多重選取。|
|3004|繫結建立錯誤|無法建立包含目前的選取範圍和指定的繫結類型的繫結。|有幾個狀況發發生這種情形。請參閱本文稍後的＜繫結建立錯誤狀況＞一節。|
|3005|繫結作業無效|此繫結類型不支援作業。|開發人員在非 _table_ 的繫結類型上，傳送新增資料列或新增資料行作業。|
|3006|繫結建立錯誤|具名的項目不存在。|找不到具名的項目。不存在含該名稱的內容控制項或資料表。|
|3007|繫結建立錯誤|找到具有相同名稱的多個物件。|衝突錯誤︰存在多個同名的內容控制項，並在將衝突設為 **true** 時失敗。|
|3008|繫結建立錯誤|指定的繫結型別與提供的具名項目不相容。|具名項目無法繫結至類型。 例如，內容控制項包含文字，但開發人員嘗試使用強制型轉型別 _table_ 進行繫結。|
|3009|繫結作業無效|不支援繫結型別。|用於回溯相容性。|
|3010|不支援的繫結作業|選取的內容必須採用資料表格式。 將資料格式化為資料表並再試一次。|開發人員想要在強制型轉型別 _matrix_ 的資料上，使用 **TableBinding** 物件的 **addRowsAsynch** 或 **deleteAllDataValuesAsynch** 方法 。|
|4000|讀取設定錯誤|指定的設定名稱不存在。|提供不存在的設定名稱。|
|4001|儲存設定錯誤|無法儲存設定。|無法儲存設定。|
|4002|設定過時錯誤|無法儲存設定，因為它們已過時。|設定已過時，且開發人員指出不要覆寫設定。|
|5000|設定過時錯誤|不支援的作業。|目前的主機不支援此作業。 例如，**document.getSelectionAsync** 是從 Outlook 中呼叫。|
|5001|內部錯誤|發生內部錯誤。|指的是內部錯誤狀況，下列任何一個原因都可能會導致此項錯誤：<br/><table><tr><td>增益集由其他使用者使用，該使用者共用大約同時建立繫結的活頁簿，您的增益集必須重試繫結。</tr></td><tr><td>發生未知錯誤。</tr></td><tr><td>作業失敗。</tr></td><tr><td>因為使用者不是授權角色的成員，所以存取遭拒。</tr></td><tr><td>因為必須是安全、加密的通訊，所以存取遭拒。</tr></td><tr><td>資料已過時，使用者需要確認啟用查詢以重新整理它。</tr></td><tr><td>已經超過網站集合 CPU 配額。</tr></td><tr><td>已經超過網站集合記憶體配額。</tr></td><tr><td>已經超過工作階段記憶體配額。</tr></td><tr><td>活頁簿處於無效狀態，無法執行作業。</tr></td><tr><td>工作階段由於非作用中而逾時，使用者必須重新載入活頁簿。</tr></td><tr><td>已超過每個使用者允許的工作階段數上限。</tr></td><tr><td>使用者已取消作業。</tr></td><tr><td>無法完成作業，因為花費的時間太長。</tr></td><tr><td>無法完成要求，必須重試。</tr></td><tr><td>產品的試用期已經過期。</tr></td><tr><td>工作階段由於非作用中已逾時。</tr></td><tr><td>使用者沒有在指定的範圍執行作業的權限。</tr></td><tr><td>使用者的區域設定不符合目前的共同作業工作階段。</tr></td><tr><td>使用者已不再連接，且必須重新整理或重新開啟活頁簿。</tr></td><tr><td>工作表中要求的範圍不存在。</tr></td><tr><td>使用者沒有編輯活頁簿的權限。</tr></td><tr><td>無法編輯活頁簿，因為它已鎖定。</tr></td><tr><td>工作階段無法自動儲存活頁簿。</tr></td><tr><td>工作階段無法在活頁簿檔案上重新整理其鎖定。</tr></td><tr><td>無法處理要求，必須重試。</tr></td><tr><td>使用者的登入資訊無法驗證，而且必須重新輸入。</tr></td><tr><td>使用者存取遭拒。</tr></td><tr><td>共用活頁簿必須更新。</tr></td></table>|
|5002|權限遭拒|目前的文件模式不允許要求的作業。|解決方案開發人員提交設定作業，但文件處於不允許修改的狀態，例如「限制編輯」。|
|5003|事件註冊錯誤|目前的物件不支援指定的事件型別。|解決方案開發人員嘗試註冊或移除註冊不存在的事件的處理常式。|
|5004|無效的 API 呼叫|目前內容中的 API 呼叫無效。|針對內容的呼叫無效，例如，嘗試在 Excel 中使用  **CustomXMLPart** 物件。|
|5005|資料過時|作業失敗，因為伺服器上的資料已過時。|伺服器上的資料需要重新整理。|
|5006|工作階段逾時|文件工作階段逾時。重新載入文件。 |工作階段已逾時。|
|5007|無效的 API 呼叫|目前的內容不支援列舉。|目前的內容不支援列舉。|
|5009|權限遭拒|拒絕存取|增益集無權呼叫特定的 API。|
|6000|無效節點|找不到指定的節點。|找不到 **CustomXmlPart** 節點。|
|6100|自訂 XML 錯誤|自訂 XML 錯誤|無效的 API 呼叫|
|7000|無效識別碼|指定的識別碼不存在。|無效識別碼|
|7001|無效瀏覽|物件位於不支援瀏覽的地方。|使用者可找到物件，但無法瀏覽它。(例如，在 Word 中，繫結是連至頁首、頁尾或註解。)|
|7002|無效瀏覽|物件已鎖定或受到保護。|使用者正在嘗試瀏覽至已鎖定或受保護的範圍。|
|7004|無效瀏覽|作業失敗，因為索引超出範圍。|使用者正在嘗試瀏覽至超出範圍的索引。|
|8000|遺漏參數|因為某些參數值遺失，我們無法設定資料表儲存格的格式。請仔細檢查參數並再試一次。|cellFormat 方法遺漏某些參數。例如，遺漏儲存格、格式或 tableOptions 參數。|
|8010|無效值|一或多個儲存格參數有不允許的值。請仔細檢查值並再試一次。|常見的儲存格參考列舉未定義。例如，All、Data、Headers。|
|8011|無效值|一或多個 tableOptions 參數有不允許的值。請仔細檢查值並再試一次。|tableOptions 的其中一個值無效。|
|8012|無效值|一或多個格式參數有不允許的值。請仔細檢查值並再試一次。|格式的其中一個值無效。|
|8020|超出範圍|資料列的索引值超出允許的範圍。使用小於資料列數目的正數值 (0 或更高)。|資料列索引超過資料表的最大資料列索引或小於 0。|
|8021|超出範圍|資料行的索引值超出允許的範圍。使用小於資料行數目的正數值 (0 或更高)。|資料行索引超過資料表的最大資料行索引或小於 0。|
|8022|超出範圍|值超出允許的範圍。|格式中的某些值超出支援的範圍。|
|9016|權限遭拒|權限遭拒|拒絕存取。|

## 繫結建立錯誤狀況

在 API 中建立繫結時，解決方案開發人員必須指出要使用的繫結類型。下表摘要不同的可能性和預期的結果繫結行為。


### Excel 中的行為

下表摘要 Excel 中的繫結行為。



|**指定繫結類型**|**實際選取範圍**|**行為**|
|:-----|:-----|:-----|
|矩陣|儲存格範圍 (包括資料表中，和單一儲存格)|會在選取的儲存格中建立類型 _matrix_ 的繫結。預期不在文件中修改。|
|矩陣|儲存格中選取的文字|會在整個儲存格中建立類型 _matrix_ 的繫結。預期不在文件中修改。|
|矩陣|多個選取範圍/無效選取範圍 (例如，使用者選取一張圖片、物件、文字藝術師等)|無法建立繫結。|
|表格|儲存格範圍 (包括單一儲存格)|無法建立繫結。|
|表格|資料表中的儲存格範圍 (包括資料表中的單一儲存格、整個資料表，或資料表中儲存格內的文字)|會在整個資料表中建立繫結。|
|表格|資料表內部和外部各有一半的選取範圍。|無法建立繫結。|
|表格|儲存格中的選取文字 (不在資料表中)。|無法建立繫結。|
|表格|多個選取範圍/無效選取範圍 (例如，使用者選取一張圖片、物件、文字藝術師等)|無法建立繫結。|
|文字|儲存格範圍|無法建立繫結。|
|文字|資料表內的儲存格範圍|無法建立繫結。|
|文字|單一儲存格|建立類型 _text_ 的繫結。|
|文字|資料表內的單一儲存格|建立類型 _text_ 的繫結。|
|文字|儲存格中選取的文字|會在整個儲存格中建立類型 _text_ 的繫結。|

### Word 中的行為

下表摘要 Word 中的繫結行為。



|**指定繫結類型**|**實際選取範圍**|**行為**|
|:-----|:-----|:-----|
|矩陣|文字|無法建立繫結。|
|矩陣|整個資料表|會建立類型 _matrix_ 的繫結。文件變更，且內容控制項必須在資料表換行。 |
|矩陣|資料表內的範圍|無法建立繫結。|
|矩陣|無效的選取範圍 (例如，多個無效的物件等等)|無法建立繫結。|
|表格|文字|無法建立繫結。|
|表格|整個資料表|建立類型 _text_ 的繫結。|
|表格|資料表內的範圍|無法建立繫結。|
|表格|無效的選取範圍 (例如，多個無效的物件等等)|無法建立繫結。|
|文字|整個資料表|建立類型 _text_ 的繫結。|
|文字|資料表內的範圍|無法建立繫結。|
|文字|多個選取範圍|最後的選取範圍會使用內容控制項換行，並繫結至該控制項。會建立類型 _text_ 的內容控制項。|
|文字|無效的選取範圍 (例如，多個無效的物件等等)|無法建立繫結。|

## 其他資源


- [Office 增益集 API 和結構描述參考](../reference/reference.md)
    
- [Office 增益集開發生命週期](../docs/design/add-in-development-lifecycle.md)
    
