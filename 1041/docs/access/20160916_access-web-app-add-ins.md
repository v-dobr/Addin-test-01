
# Access Web アプリ用のアドインを作成する



この記事では、Visual Studio 2015 を使用して Access Web アプリ対象の Office アドインを開発する方法について説明します。

>
  **注:**VBA を使用した Access 向けソリューション開発の詳細は、MSDN の「[Access](https://msdn.microsoft.com/en-us/library/fp179695.aspx)」を参照してください。

## 前提条件

Access Web アプリ を対象とした Office アドイン の作成に必要なものは次のとおりです。


- Visual Studio 2015

- SharePoint Online サイト (多数の Office 365 サブスクリプションに付属)。このサイトにはアドイン カタログが必要です。詳細については「 [SharePoint アドイン カタログの設定 ](../publish/publish-task-pane-and-content-add-ins-to-an-add-in-catalog.md)」を参照してください。


 >**メモ**  Office アドイン は SharePoint Online でホストされる Access Web アプリ、または Office 365 に対応しています。Access 2013 デスクトップ アプリケーションは、Office アドイン をサポートしていません。Access Web アプリ を対象とする Office アドイン は、Office.js バージョン 1.1 以降でサポートされています。


## Visual Studio でプロジェクトを作成する


1.  Visual Studio を開き、メニューで **[ファイル]**、**[新規]**、**[プロジェクト]** の順に選択します。**[新規プロジェクト]** ダイアログ ボックスが開きます。

2. [ **新規プロジェクト**] ダイアログ ボックスの左側のウィンドウで、[ **インストール済み**]、[ **テンプレート**]、[ **Visual C#**]、[ **Office/SharePoint**]、[ **Office アドイン**] の順に移動します。

3. [ **新規プロジェクト**] ダイアログ ボックスの中央のウィンドウで、[ **Office アドイン**] を選択します。

4. ダイアログ ボックスの下部にプロジェクト名を入力して、[ **OK**] を押します。[ **Office アドインの作成**] ダイアログ ボックスが開きます。

5. [ **Office アドインの作成**] ダイアログ ボックスで、[ **コンテンツ**] を選択してから [ **次へ**] を押します。

6. [ **Office アドインの作成**] ダイアログ ボックスの次の画面で、[ **基本アドイン**] または [ **ドキュメント視覚化アドイン**] を選択します。このとき、必ず [ **Access**] のチェック ボックスを選択してください。

7. 完了したら、[ **終了**] を選択します。Visual Studio は、作業の基となるスターター プロジェクトを作成します。

8. **ソリューション エクスプローラー**で、プロジェクトの Web プロジェクト (**project_name>Web**) を選びます。 プロパティ ウィンドウで、**SSL URL** のエントリを探します。 `https://localhost:44314/` のように表示されます。 この URL を選び、クリップボードにコピーします。 後で必要になります。

9. **[ソリューション エクスプローラー]** でプロジェクト名を右クリックします。コンテキスト メニューで **[発行]** を選択します。**[アドインの発行]** ウィザードが開きます。

10. **[アドインの発行]** ウィザードで、**[現在のプロファイル]** の横にあるドロップダウン リストを選択します。ドロップダウン リストで、**[新規]** を選択します。**[Office 用アドインと SharePoint アドインの発行]** ダイアログ ボックスが開きます。

11. このダイアログ ボックスで、[ **プロファイルの新規作成**] を選び、認識可能なプロファイル名を入力してから、[ **終了**] を押します。[ **Office アドインと SharePoint アドインの発行**] ダイアログ ボックスが閉じて、[ **アドインの発行**] ウィザードに戻ります。

12. このウィザードで、[ **アドインをパッケージ化する**] を選択します。これによって、SharePoint のアドインのカタログに発行できるようにアドインが最終処理されます。

13. 次のページの  **[Web サイトがホストされている場所]** で、Web サイトのホストの URL を入力します。これは、ステップ 8 でコピーした **SSL URL** の値にすることができます。次に、[ **完了**] を選択します。

14. **[ソリューション エクスプローラー]** で、プロジェクト マニフェスト ノードを (プロジェクト名の下から直接) 右クリックして、ファイル エクスプローラーの **[フォルダーを開く]** を選択します。このファイルへのパスをメモしてください。この値は後で必要になります。


 >**メモ**  アドインを Access web アプリ で展開せずにデバッグすることはできません。


## マニフェストおよび Home.Html ファイルを確認する


1. Visual Studio プロジェクトで  **Home.html** ファイルを開き、office.js スクリプト ライブラリを参照する行を探します。

```html
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
```
 >**メモ**: スクリプト タグは Office.js のバージョン 1.1 以降を参照しています。Access はバージョン 1.1 で導入された API 要素を使用します。

2. プロジェクトに関連付けられたマニフェスト ファイルを開きます。このファイルのファイル名にはプロジェクト名および拡張子として「.xml」が付けられます。

3.  マニフェスト ファイルで、「 **Hosts**」セクションを探してから、「 **Host**」エントリを探します。

```xml
  <Hosts> <Host Name="Database" /> </Hosts>
```
 >**メモ**: ここには、アドインを使用できるアプリケーションが一覧表示されています。**[Office アドインの作成]** ダイアログ ボックスで **[Access]** を選択しているため、**データベース**が一覧に表示されます。Excel を含めた場合は、**ブック**のエントリも含まれます。

Office アドインと SharePoint アドイン は Web ベースです。アドインのコードが Web サーバーでホストされる必要があります。この例で、Web サーバーとはお使いの開発用コンピューターです。テスト用アドインを提供するためにはサーバーが実行している必要があります。つまり、SharePoint 内でアドインの表示とデバッグを行う時には Visual Studio が実行している必要があるということです。

ユーザーがアドインを検索して使用するためには、アドインが SharePoint のアドイン カタログに登録されている必要があります。アドイン カタログに必要な情報は、マニフェスト ファイルの中にあります。

 >**メモ**  Office アドイン をホストする Access web アプリ を作成する必要があります。


## アドインを SharePoint のオンライン カタログに発行する


1.  SharePoint Online または Office 365 にサインインし、ページ上部の Office 365 ツール バーにある  **[管理]** を選択して、 **SharePoint 管理センター** に移動します。

2. [ **SharePoint 管理センター**] ページの左側のリンク バーで  **[アドイン]** を選択すると、アドイン ビューに移動します。

3. ページ中央のウィンドウで [ **アドイン カタログ**] を選択すると、[ **カタログ**] ページに移動します。

4. [ **カタログ**] ページで、[ **Office アドインの配布**] を選択すると、[ **Office アドイン**] というディレクトリ ページに移動します。ここにインストールされたすべての Office アドイン が一覧表示されます。

5. [ **Office アドイン**] ページ上部にある [ **新規アドイン** ] を選択すると、[ **ドキュメントの追加**] ダイアログ ボックスが表示されます。

6. **[ドキュメントの追加]** ダイアログ ボックスで、 **[参照]** を選び、Visual Studio プロジェクトのマニフェスト ファイルの場所に移動します。前にマニフェスト ファイルのアドレスをコピーしてある場合は、このダイアログに貼り付けます。

7. プロジェクトのマニフェスト ファイルを選択し、 **[OK]** を選択します。SharePoint はアドインをローカルの SharePoint ライブラリに追加します。


 >**メモ**  この手順では、SharePoint にテスト サイトが作成されていることを想定しています。作成されていない場合は、SharePoint ウィンドウ上部の  **[サイト]** タブから作成します。利用可能な場合は、既存の Access Web アプリ を使用できます。


## アドインをホストする Access web アプリ を作成する


1. テスト サイトに移動します。左側のリンク バーで、 **[サイト コンテンツ]** を選択すると、テスト サイトにある [ **サイト コンテンツ**] ページに移動します。

2. [ **サイト コンテンツ**] ページで、[ **アドインの追加**] を選択すると、[ **サイト コンテンツ ? 自分のアドイン**] ページに移動します。

3. [ **サイト コンテンツ ? 自分のアドイン**] ページで、ページ上部の検索バーを使って  **Access アプリ** を検索します。

4. **Access アプリ**のタイルが表示されます。

     >**注**  これは Office アドインではなく、新しい Access Web アプリであることに注意してください。 この Access Web アプリが、Office アドインをホストします。
5. このタイルを選ぶと、 **[Access アプリ の追加]** ダイアログ ボックスが表示されます。Accessアプリ に一意の名前を付けて入力し、 **[作成]** を押します。SharePoint がアプリ を作成するまでしばらくかかることがあります。終了すると、Accessアプリ が、 **サイト コンテンツ** ページに表示され、横に **[新規]** ラベルが付きます。

6. Accessアプリ は、SharePoint で開いて表示する前に、デスクトップ版の Microsoft Access 2013 で開いてデータを追加することが必要になります。


## アドインを Access Web アプリ に追加する


1. Access Web アプリ を開きます。

2. [SharePoint] タブ バー上で左上にある歯車アイコンを選択します。メニューが表示され、[ **Office アドイン**] メニュー項目を選ぶと、 **[Office アドイン]** ダイアログ ボックスが表示されます。

3. [ **自分の所属組織**] ビューを選択し、利用可能な Office アドイン が SharePoint によってダイアログ ボックスに表示されるまで少し待ちます。

    ダイアログ ボックスのアドインの 1 つに、前の手順で登録した Office アドインが表示されます。 そのアドインを選んで、Access Web アプリに追加します。 アプリが検出されて Access Web アプリのページに表示されるためには、アプリが Visual Studio で実行されている必要があることに注意してください。


## Office 用アドインをデバッグする

アドインをデバッグするには、Internet Explorer で F12 を押すか、ブラウザーのタブ バーにある歯車アイコンを選択します (SharePoint ページの歯車アイコンとは異なります)。Internet Explorer 11 が提供する F12 デバッグ ツールが起動します。他のブラウザーをお使いの場合は、ブラウザーのマニュアルを確認してデバッグ モードに入る方法を確認してください。

この時点で、ブレークポイントの設定、JavaScript コードのステップの実行、DOM の探索、コードの変更を行って、Access Web アプリ を対象とする Office アドイン に変更箇所が表示されていることを確認できます。詳細については、「 [F12 開発者用ツール](http://msdn.microsoft.com/library/ie/bg182326%28v=vs.85%29)」を参照してください。


## 次の手順

サンプル「 [Office 365: アクセス Web アプリでのデータのバインドと操作](https://code.msdn.microsoft.com/officeapps/Office-365-Bind-and-4876274e)」をダウンロードして、Access web アプリ でデータを処理する Office アドイン を実装する方法についてご覧ください。


## その他のリソース



- [アドイン用の JavaScript API について](../develop/understanding-the-javascript-api-for-office.md)

- [JavaScript API for Office](../../reference/javascript-api-for-office.md)

