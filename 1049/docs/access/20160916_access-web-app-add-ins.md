
# Создание надстроек для веб-приложений Access



В этой статье показано, как с помощью Visual Studio 2015 создать надстройку Office, нацеленную на веб-приложения Access.

>
  **Примечание.** Дополнительные сведения о разработке решений для Access с помощью VBA см. в статье [Access](https://msdn.microsoft.com/en-us/library/fp179695.aspx) на сайте MSDN.

## Необходимые компоненты

Чтобы создать Надстройка Office для Веб-приложения Access, вам потребуются:


- Visual Studio 2015

- сайт SharePoint Online (включен во многие планы подписки Office 365). Этот сайт должен включать каталог надстроек. Подробная информация — в статье [Инструкции. Настройка каталога надстроек в SharePoint](../publish/publish-task-pane-and-content-add-ins-to-an-add-in-catalog.md).


 >**Примечание.** Надстройки Office совместимы с Веб-приложения Access, размещенным в SharePoint Online или Office 365. Классическое приложение Access 2013 не поддерживает Надстройки Office. Надстройки Office, предназначенные для Веб-приложения Access, поддерживаются Office.js 1.1 и более поздних версий.


## Создание проекта в Visual Studio


1.  Откройте Visual Studio и выберите команды **Файл**, **Создать**, **Проект**. Откроется диалоговое окно **Новый проект**.

2. В левой области диалогового окна **Новый проект** перейдите к разделу **Установленные**, **Шаблоны**, **Visual C#**, **Office/SharePoint**, **Надстройки Office**.

3. В центральной области диалогового окна **Новый проект** выберите **Надстройка Office**.

4. В нижней части диалогового окна введите имя проекта и нажмите кнопку **ОК**. Откроется диалоговое окно **Создание надстройки Office**.

5. В диалоговом окне **Создание надстройки Office** выберите **контентную** надстройку и нажмите кнопку **Далее**.

6. На следующем экране диалогового окна **Создание надстройки Office** выберите **Базовая надстройка** или **Надстройка для визуализации документов**, а затем убедитесь, что установлен флажок **Access**.

7. В завершение нажмите кнопку **Готово**. Visual Studio создаст начальный проект, на котором будет основываться дальнейшая работа.

8. В **обозревателе решений** выберите веб-проект (**<имя_проекта> > Web**). В области свойств найдите пункт **URL-адрес SSL**. Он должен выглядеть примерно следующим образом: `https://localhost:44314/`. Выделите этот URL-адрес и скопируйте его в буфер обмена. Вскоре он вам понадобится.

9. Щелкните правой кнопкой мыши имя проекта в **обозревателе решений**. В контекстном меню выберите команду **Опубликовать**. Откроется **мастер публикации надстроек**.

10. В **мастере публикации надстроек** откройте раскрывающийся список рядом с **текущим профилем**. Выберите пункт **создать**. Откроется диалоговое окно **Публикация надстроек для Office и SharePoint**.

11. В этом диалоговом окне нажмите **Создать новый профиль**, введите узнаваемое имя профиля и нажмите кнопку **Готово**. Диалоговое окно **Публикация надстроек для Office и SharePoint** закроется, и снова откроется **мастер публикации надстроек**.

12. В мастере выберите **Упаковать надстройку**. После этого надстройка будет готова к публикации в каталоге надстроек SharePoint.

13. На следующей странице в поле **Где размещен ваш веб-сайт?** укажите URL-адрес своего веб-сайта. Это может быть значение **URL-адрес SSL**, скопированное на этапе 8. Затем нажмите кнопку **Готово**.

14. В **обозревателе решений** щелкните правой кнопкой мыши узел манифеста проекта сразу под именем проекта и выберите команду **Открыть папку в проводнике**. Запишите путь к этому файлу. Это значение потребуется позже.


 >**Примечание.** Надстройку невозможно отлаживать, не развернув ее в Веб-приложение Access.


## Просмотр манифеста и файла Home.html


1. В проекте Visual Studio откройте файл **Home.html** и найдите строки, ссылающиеся на библиотеку сценариев office.js.

```html
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/Office.js" type="text/javascript"></script>
```
 >**Примечание.** Обратите внимание, что тег сценария ссылается на Office.js версии 1.1 (и выше). Access использует элементы API, добавленные в версии 1.1.

2. Откройте файл манифеста, связанный с вашим проектом. Его имя будет совпадать с названием проекта, и он будет иметь расширение XML.

3.  Найдите в файле манифеста раздел **Hosts** и строку **Host**.

```xml
  <Hosts> <Host Name="Database" /> </Hosts>
```
 >**Примечание.** Здесь указаны поддерживаемые ведущие приложения, которые могут использовать надстройку. Так как мы выбрали **Access** в диалоговом окне **Создание надстроек для Office**, в манифесте указано значение **Database**. Если вы включили Excel, в манифесте также будет указано значение **Workbook**.

Надстройки Office и SharePoint основаны на веб-интерфейсе. Код надстройки должен быть размещен на веб-сервере. В этом примере веб-сервером является компьютер разработчика. Для тестирования надстройки сервер должен быть запущен. В нашем случае во время просмотра и отладки надстройки в SharePoint должен быть запущен Visual Studio.

Чтобы пользователь мог найти и использовать надстройку, необходимо зарегистрировать ее в каталоге надстроек SharePoint. Данные, необходимые для каталога надстроек, указаны в файле манифеста.

 >**Примечание.** Необходимо создать ведущее Веб-приложение Access для Надстройка Office.


## Публикация надстройки в каталоге SharePoint Online


1.  Войдите в SharePoint Online или Office 365 и перейдите в **Центр администрирования SharePoint**, нажав **Администратор** на панели инструментов Office 365 в верхней части страницы.

2. На странице **Центра администрирования SharePoint** в области ссылок слева выберите **надстройки**. Откроется представление надстроек.

3. В центральной области страницы выберите **Каталог надстроек**. Откроется страница **Каталог**.

4. На странице **Каталог** выберите **Распространение надстроек для Office**. Откроется страница каталога под названием **Надстройки Office**, на которой перечислены все установленные Надстройки Office.

5. В верхней части страницы **Надстройки Office** нажмите **новая надстройка**. Откроется диалоговое окно **Добавление документа**.

6. В диалоговом окне **Добавление документа** нажмите **Обзор** и перейдите к расположению файла манифеста в проекте Visual Studio. Если вы уже скопировали адрес файла манифеста, его можно вставить в этом диалоговом окне.

7. Выберите файл манифеста проекта и нажмите кнопку **ОК**. SharePoint добавит надстройку в локальную библиотеку SharePoint.


 >**Примечание.** В этом руководстве предполагается, что вы создали тестовый сайт в SharePoint. Если это не так, вы можете создать тестовый сайт, открыв вкладку **Сайты** в верхней части окна SharePoint. Вы можете использовать имеющуюся версию Веб-приложения Access, если она доступна.


## Создание Веб-приложение Access для размещения надстройки


1. Перейдите на тестовый сайт. В левой области ссылок выберите **Контент сайта**. Откроется страница **Контент сайта**.

2. На странице **Контент сайта** нажмите **добавить надстройку**. Откроется страница **Контент сайта — надстройки**.

3. На странице **Контент сайта — надстройки** с помощью панели поиска в верхней части страницы выполните поиск по запросу **Приложение Access**.

4. Должна появиться плитка **Веб-приложение Access**.

     >**Примечание**. Помните, что это не надстройки Office, а новые веб-приложения Access. Ваша надстройка будет размещена в этих веб-приложениях Access.
5. Если щелкнуть эту плитку, откроется диалоговое окно **Добавление приложение для Access**. Введите уникальное имя приложение для Access и нажмите **Создать**. Создание приложение в SharePoint может занять некоторое время. По завершении создания приложение для Access она появится на странице **Контент сайта** с отметкой **новое**.

6. Теперь нужно открыть приложение для Access в классической версии Microsoft Access 2013 и добавить данные, чтобы их можно было открывать и просматривать в SharePoint.


## Добавление надстройки в Веб-приложения Access


1. Откройте Веб-приложения Access.

2. В строке вкладок SharePoint нажмите значок шестеренки в левом верхнем углу. Нажмите его, и откроется меню. Выберите пункт **Надстройки Office**. Откроется диалоговое окно **Надстройки Office**.

3. Выберите представление **Моя организация** и подождите, пока SharePoint заполнит диалоговое окно доступными вам Надстройки Office.

    В диалоговом окне среди надстроек должна находиться и надстройка Office, которая была зарегистрирована при выполнении предыдущей процедуры.  Выберите эту надстройку, чтобы вставить в свой список веб-приложений Access. Помните, что для обнаружения и отображения на странице веб-приложений Access данное приложение должно быть запущено в Visual Studio.


## Отладка надстройки Office

Для отладки надстройки в Internet Explorer нажмите клавишу F12 или значок шестеренки на панели вкладок браузера (не тот значок шестеренки, который отображается на странице SharePoint). Откроются средства отладки Internet Explorer 11. Если вы используете другой браузер, ознакомьтесь с документацией по нему, чтобы узнать, как включить режим отладки.

Теперь вы можете устанавливать точки останова, пошагово выполнять код JavaScript, изучать DOM и изменять код, чтобы убедиться, что изменения отображаются в Надстройка Office, предназначенной для Веб-приложения Access. Подробная информация — в статье [Использование средств разработчика F12](http://msdn.microsoft.com/library/ie/bg182326%28v=vs.85%29).


## Дальнейшие действия

Скачайте пример [Office 365. Привязка данных и управление ими в веб-приложении Access](https://code.msdn.microsoft.com/officeapps/Office-365-Bind-and-4876274e), чтобы узнать больше о том, как реализовать Надстройка Office, которая управляет данными в Веб-приложение Access.


## Дополнительные ресурсы



- [Общие сведения об API JavaScript для надстроек](../develop/understanding-the-javascript-api-for-office.md)

- [API JavaScript для Office](../../reference/javascript-api-for-office.md)

