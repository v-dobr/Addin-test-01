# Метод UI.displayDialogAsync

Отображает диалоговое окно в приложении Office. 

## Требования

|Ведущее приложение|Представлены в|Последнее изменение в |
|:---------------|:--------|:----------|
|Word, Excel, PowerPoint|1.1|1.1|
|Outlook|Mailbox 1.4|Mailbox 1.4|

Этот метод доступен в [наборе требований](../../docs/overview/specify-office-hosts-and-api-requirements.md) DialogAPI. Чтобы указать набор требований DialogAPI, используйте в манифесте приведенный ниже код.

```xml
 <Requirements> 
   <Sets DefaultMinVersion="1.1"> 
     <Set Name="DialogAPI"/> 
   </Sets> 
 </Requirements> 

```

Чтобы определять этот API в среде выполнения, используйте приведенный ниже код.

```js
 if (Office.context.requirements.isSetSupported('DialogAPI', 1.1)) 
    {  
         // Use Office UI methods; 
    } 
 else 
     { 
         // Alternate path 
     } 
```



### Поддерживаемые платформы
В настоящее время набор требований DialogAPI поддерживается на следующих платформах:

  - Office для Windows Desktop 2016 (сборка 16.0.6741.0000 или более новая)
  - Office для iPad (сборка 1.22 или более новая)
  - Office для Mac (сборка 15.20 или более новая) 

В ближайшее время станут доступны другие платформы. 

## Синтаксис

```js
office.context.ui.displayDialogAsync(startAddress, options, callback);
```
##Примеры

Простой [пример](https://github.com/OfficeDev/Office-Add-in-Dialog-API-Simple-Example/), в котором используются метод **displayDialogAsync**, на сайте GitHub.

Пример [проверки подлинности в клиенте Office 365 для надстройки на AngularJS](https://github.com/OfficeDev/Word-Add-in-AngularJS-Client-OAuth) на сайте GitHub.

 
## Параметры

| Параметр    | Тип   |Описание|
|:---------------|:--------|:----------|
|startAddress|string|Принимает исходный URL-адрес, содержащий префикс HTTPS(TLS), который открывается в диалоговом окне. <ul><li>Начальная страница и родительская страница должны быть в одном домене. После загрузки начальной страницы можно перейти к другим доменам.</li><li>Любая страница, вызывающая [office.context.ui.messageParent](officeui.messageparent.md), также должна быть в домене родительской страницы.</li></ul>|
|options|object|Необязательный. Принимает объект options, определяющий поведение диалогового окна.|
|callback|object|Принимает метод обратного вызова, обрабатывающий попытку создания диалогового окна.|
    
### Параметры конфигурации
Для диалогового окна доступны следующие параметры конфигурации.


| Свойство     | Тип   |Описание|
|:---------------|:--------|:----------|
|**width**|object|Необязательный. Определяет ширину диалогового окна в процентах от ширины текущего экрана. Значение по умолчанию — 80 %. Минимальное разрешение — 250 пикселей.|
|**height**|object|Необязательный. Определяет высоту диалогового окна в процентах от высоты текущего экрана. Значение по умолчанию — 80 %. Минимальное разрешение — 150 пикселей.|
|**displayInIFrame**|object|Необязательный. Определяет, должно ли диалоговое окно отображаться в IFrame в клиентах Office Online. Этот параметр игнорируется клиентами для настольных ПК. Ниже перечислены возможные значения.<ul><li>False (по умолчанию) — диалоговое окно будет отображаться как всплывающее окно в браузере. Рекомендуется использовать для страниц проверки подлинности, которые не могут отображаться в IFrame. </li><li>True — диалоговое окно будет отображаться как плавающий оверлей в IFrame. Этот вариант удобнее для пользователей и производительнее.</li>|


## Значение обратного вызова
Когда выполняется функция, переданная в параметр _callback_, она получает объект [AsyncResult](../../reference/shared/asyncresult.md), к которому можно получить доступ с помощью единственного параметра функции обратного вызова.

В функции обратного вызова, переданной методу **displayDialogAsync**, вы можете использовать свойства объекта **AsyncResult**, чтобы получить следующие сведения:



|**Свойство**|**Применение**|
|:-----|:-----|
|[AsyncResult.value](../../reference/shared/asyncresult.value.md)|Доступ к объекту [Dialog](../../reference/shared/officeui.dialog.md).|
|[AsyncResult.status](../../reference/shared/asyncresult.status.md)|Определяет, удалось ли выполнить операцию.|
|[AsyncResult.error](../../reference/shared/asyncresult.error.md)|Получает доступ к объекту [Error](../../reference/shared/error.md), который содержит сведения об ошибке, если операция завершилась неудачно.|
|[AsyncResult.asyncContext](../../reference/shared/asyncresult.asynccontext.md)|Доступ к пользовательскому объекту или значению, если они передаются в виде параметра _asyncContext_.|


## О чем нужно помнить при создании диалоговых окон
К диалоговым окнам применяются следующие рекомендации по оформлению:

- В любой момент времени может быть открыто только одно диалоговое окно.
- Пользователь может перемещать все диалоговые окна и изменять их размер.
- При открытии все диалоговые окна размещаются по центру экрана.
- Диалоговые окна отображаются поверх ведущего приложения в порядке создания.

Примеры применения диалогового окна:

- Отображение страниц проверки подлинности для сбора учетных данных пользователей.
- Отображение экрана ошибки, хода выполнения или ввода данных с помощью команды ShowTaspane или ExecuteAction.
- Временное увеличение пространства, доступного пользователю для выполнения задачи.

Не используйте диалоговое окно для работы с документом. Используйте область задач. 

Шаблон, который можно использовать для создания [диалогового окна](https://github.com/OfficeDev/Office-Add-in-UX-Design-Patterns/blob/master/Patterns/Client_Dialog.md), см. в репозитории шаблонов на сайте GitHub.
